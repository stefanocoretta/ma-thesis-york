---
title: "Linear mixed effect model"
author: "Stefano Coretta"
date: "22/02/2017"
output: pdf_document
---

```{r setup, include=FALSE}
opts_knit$set(root.dir=normalizePath('../'))
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(dplyr)
library(tidyr)
library(lme4)
library(effects)
library(afex)
library(knitr)
```

```{r data}
words <- read_csv("task/task-src/words.csv")

icelandic <- read_csv("results/results.csv", na = "--undefined--") %>%
    left_join(y = words) %>%
    mutate_if(is.character, as.factor)
```

```{r lmer}
model1 <- lmer(dur_vowel ~ aspiration + vor + (1|speaker) + (1|word),
              data = icelandic
              )

summary(model1)
plot(allEffects(model1))
```

```{r mixed-all}
mixed(dur_vowel ~ aspiration + place + manner + syllables + vowel +
                  cons1 + vor + (1|speaker) + (1|word),
              data = icelandic)
```


```{r }
model2 <- lmer(dur_voic ~ aspiration + place + manner + syllables + vowel +
                  cons1 + vor + (1|speaker) + (1|word),
              data = icelandic
              )

summary(model2)
plot(allEffects(model2))
```

## Stops

```{r lmer-stops}
icelandic.stops <- filter(icelandic, manner == "stop")
model.stops <-  lmer(dur_vowel ~ aspiration + vor + (1 + aspiration|speaker) + (1|word),
                     data = icelandic.stops, REML = FALSE
                     )

summary(model.stops)
plot(allEffects(model.stops))
```

```{r mixed-stops}
mixed(dur_vowel ~ aspiration + vor + (1 + aspiration|speaker) + (1|word),
              data = icelandic.stops)
```

```{r likelihood-stops}
model.stops.null <- lmer(dur_vowel + vor ~ (1|speaker) + (1|word),
              data = icelandic.stops, REML = FALSE)

anova(model.stops.null, model.stops)
```

